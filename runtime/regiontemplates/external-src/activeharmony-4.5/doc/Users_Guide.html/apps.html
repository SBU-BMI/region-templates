<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Active Harmony User&#39;s Guide: Harmony Applications</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Active Harmony User&#39;s Guide
   &#160;<span id="projectnumber">4.5</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('apps.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Harmony Applications </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="apps_svr"></a>
Harmony Server</h1>
<p>For some advanced uses of auto-tuning, multiple clients need to communicate to a single tuning session. For instance, if an MPI program is being tuned, all the constituent ranks may participate in parallel to expedite the search. In this case, the Active Harmony Server must be used as a central multiplexing unit.</p>
<div class="image">
<img src="multi-client.svg" alt="multi-client.svg"/>
<div class="caption">
Supporting multiple clients within the feedback loop.</div></div>
<h2>Usage Syntax</h2>
<pre class="fragment">hserver [config_file_name]
</pre><p>The server has no mandatory parameters, and can be started with a plain invocation. A configuration file may optionally be provided as a parameter, otherwise <code>harmony.cfg</code> will be used (if it exists). The configuration system provides a unified key/value store that may be queried by all members of the Active Harmony framework. See the <a class="el" href="cfg.html">Configuration</a> section for more details.</p>
<p><b>Harmony Server Configuration Variables</b> </p>
<table class="doxtable">
<tr>
<th>Key </th><th>Type </th><th>Default </th><th>Description</th></tr>
<tr>
<td>SERVER_PORT </td><td>Integer </td><td>1979 </td><td>The port that the Harmony Server will bind and listen to. Read only once when the Harmony Server is loaded. </td></tr>
</table>
<p>Any configuration directives loaded by the server will be automatically merged with the sessions that it manages. If there is a key conflict between the server and session configuration environment, the session's key takes precedence.</p>
<h2>Client Modification</h2>
<p>Using the Active Harmony server is functionally equivalent to the stand-alone case. Users need only change two environment variables on the client machines.</p>
<table class="doxtable">
<tr>
<th>Environment Variable </th><th>Description</th></tr>
<tr>
<td>HARMONY_S_HOST </td><td>Hostname of the machine running the Harmony Server. </td></tr>
<tr>
<td>HARMONY_S_PORT </td><td>TCP/IP port allocated by Harmony Server. </td></tr>
</table>
<p>When defined, these environment variables instruct clients to connect to the specified hostname:port pair instead of spawning a local tuning session. Multiple clients may then work together on a single search problem.</p>
<h2>Web Server</h2>
<p>The Harmony Server also provides a built-in web server as an interface to the sessions it controls. Use a Javascript-enabled web browser to connect to the host and port the server is running on. For example, the URL for connecting to a locally-running server on the default port would be: </p>
<pre class="fragment">http://localhost:1979
</pre><p>Replace the host or port to match the desired Harmony Server as necessary. A screen similar to the following should appear:</p>
<div class="image">
<img src="hserver1.png" alt="hserver1.png"/>
<div class="caption">
Session selection menu of the web interface.</div></div>
 Since the Harmony Server can manage more than one session at a time, there may be multiple lines in the table. You can view detailed information regarding a specific session by clicking its name in the first column. This should produce a screen similar to the following:</p>
<div class="image">
<img src="hserver2.png" alt="hserver2.png"/>
<div class="caption">
Detailed view of a particular session.</div></div>
 The detailed session view includes several ways to help you visualize the current session. On the left, a table of the ten most recently reported point/performance pairs, as well as the best performing point found thus far. The list can be extended to display as many as 50 entries. On the right, a plot of the entire search is drawn with respect to performance value along the y-axis, and time along the x-axis. Hovering the mouse pointer over any individual marker will produce details of the point/performance pair.</p>
<h1><a class="anchor" id="apps_tuna"></a>
Tuna: The Command-line Tuning Shell</h1>
<p>Tuna is a tool for tuning the parameters of command-line applications. Given a target application and a tuning specification, Tuna is able to perform a search for optimal parameter values automatically.</p>
<h2>Usage Syntax</h2>
<pre class="fragment">tuna &lt;tunable_variables&gt; [options] program [program_args]
</pre><h2>Tunable Variable Declaration</h2>
<table class="doxtable">
<tr>
<th>Flag Usage </th><th>Description</th></tr>
<tr>
<td><code>-i=&lt;name&gt;,&lt;min&gt;,&lt;max&gt;,&lt;step&gt;</code> </td><td>Declare an integer number variable called <em>name</em> where valid values fall between <em>min</em> and <em>max</em> with a stride of size <em>step</em>. </td></tr>
<tr>
<td><code>-r=&lt;name&gt;,&lt;min&gt;,&lt;max&gt;,&lt;step&gt;</code> </td><td>Declare a real number variable called <em>name</em> where valid values fall between <em>min</em> and <em>max</em> with a stride of size <em>step</em>. </td></tr>
<tr>
<td><code>-e=&lt;name&gt;,&lt;val_1&gt;,..,&lt;val_n&gt;</code> </td><td>Declare an enumerated variable called <em>name</em> whose values must be <em>val_1</em> or <em>val_2</em> or .. or <em>val_n</em>. </td></tr>
</table>
<p>Tuna provides three built-in methods for measuring the performance of a target application. These include wall-time, user-time, or system-time used by the target application. To support a wider range of possible performance metrics, a fourth method monitors output from the target application and parses a floating-point value from its final line as the performance value. This allows virtually any measure of performance, so long as it can be collected by an external wrapper program and printed.</p>
<h2>Additional Options</h2>
<table class="doxtable">
<tr>
<th>Flag Usage </th><th>Description</th></tr>
<tr>
<td><code>-m=&lt;metric&gt;</code> </td><td>Specify how to measure the performance of the child process, where <em>metric</em> is:<br/>
 <b>wall</b> for wall time (<em>default</em>),<br/>
 <b>user</b> for user CPU time,<br/>
 <b>sys</b> for system CPU time, or<br/>
 <b>output</b> to parse a number from the final line of child output. </td></tr>
<tr>
<td><code>-q</code> </td><td>Suppress client application output. </td></tr>
<tr>
<td><code>-v</code> </td><td>Print additional informational output. </td></tr>
<tr>
<td><code>-n=&lt;num&gt;</code> </td><td>Run child program at most <em>num</em> times. </td></tr>
</table>
<p>If the tunable variables cannot be supplied directly as arguments to the client application, then you must provide additional parameters to describe the format of the argument vector. Each argument (starting with and including the program binary) may include a percent sign (%) followed by the name of a previously defined tunable variable. This identifier may be optionally bracketed by curly-braces. Values from the tuning session will then be used to complete a command-line instance. A backslash (\) may be used to produce a literal %.</p>
<h2>Usage Example</h2>
<pre class="fragment">./tuna -i=tile,1,10,1 -i=unroll,2,12,2 -n=25 ./matrix_mult -t %tile -u %unroll
</pre><p>The above usage example defines a parameter space with two integer variables via the <code>-i</code> flag. The first variable (<em>tile</em>) is permitted to be between 1 and 10, inclusive. The second variable (<em>unroll</em>) is permitted to be even numbers between 2 and 12, inclusive. The tuning loop is limited to at most 25 iterations due to the optional <code>-n</code> flag. The remaining parameters specify that the target application (<code>matrix_mult</code>) should be launched with Harmony-chosen values for <em>tile</em> and <em>unroll</em> as the second and fourth arguments, respectively. Wall-time of each execution will be measured and reported, as it is the default performance metric.</p>
<p>Tuna makes any command-line application that provides performance related parameters a viable target for auto-tuning. As an example, the GCC compiler suite provides hundreds of command-line arguments to control various details of its compilation process. Finding optimal values for these arguments is a natural task for Tuna. A user need only specify which arguments are relevant for their optimization task and a method to measure the resulting performance. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.1.1 </li>
  </ul>
</div>
</body>
</html>
